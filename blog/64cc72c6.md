---
title: Hyper-V安装Linux虚拟机并配置静态IP
description: Hyper-V安装Linux虚拟机并配置静态IP
published: true
date: '2025-04-13T02:07:05.000Z'
dateCreated: '2025-04-13T02:07:05.000Z'
tags: 运维手册
editor: markdown
---

本文主要介绍了如何在Hyper-V平台上安装红帽系列Linux虚拟机，并配置静态IP地址。整体流程涵盖了网络环境的初期配置、虚拟机的创建以及详细的静态IP设置步骤，使整个搭建过程清晰可循。

首先，文章从Hyper-V环境的网络配置入手，通过创建虚拟交换机和虚拟机，确保虚拟化环境的稳定运行。接着，作者演示了如何获取IP地址、子网掩码、网关和DNS信息，详细说明了每个参数的作用与获取方法，以便准确无误地配置网络。

最后，在静态IP配置部分，通过修改Linux系统下的网络配置文件，成功实现了从动态分配到静态配置的转换。全程配合命令示例和截图，帮助读者直观理解和操作。整体内容不仅具有较强的实践指导意义，也为后续的系统调试与运维提供了宝贵参考。

<!-- more -->

> 本文仅仅适用于红帽系列的系统，其他系统请自行修改。

配置Hyper-V网络
---

![](https://lbs-images.oss-cn-shanghai.aliyuncs.com/202504130211107.png)

![](https://lbs-images.oss-cn-shanghai.aliyuncs.com/202504130214555.png)

![](https://lbs-images.oss-cn-shanghai.aliyuncs.com/202504130213595.png)

创建虚拟机
---

![](https://lbs-images.oss-cn-shanghai.aliyuncs.com/202504130216406.png)

![](https://lbs-images.oss-cn-shanghai.aliyuncs.com/202504130216794.png)

![](https://lbs-images.oss-cn-shanghai.aliyuncs.com/202504130217034.png)

![](https://lbs-images.oss-cn-shanghai.aliyuncs.com/202504130217609.png)

![](https://lbs-images.oss-cn-shanghai.aliyuncs.com/202504130218817.png)

![](https://lbs-images.oss-cn-shanghai.aliyuncs.com/202504130219857.png)

![](https://lbs-images.oss-cn-shanghai.aliyuncs.com/202504130220441.png)

![](https://lbs-images.oss-cn-shanghai.aliyuncs.com/202504130220261.png)

![](https://lbs-images.oss-cn-shanghai.aliyuncs.com/202504130221911.png)

配置静态IP
---

> 系统安装成功以后，登录终端后才可配置静态IP。
> 
> 此种方式为“桥接”，虚拟机与宿主机为同一网段，网络连通性好。

1. 获取IP与子网掩码，inet后的内容为IP（192.168.231.152），netmask后的内容为子网掩码（255.255.255.0）。

    ```shell
    [node@k8s-master ~]$ ifconfig
    ens33: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
            inet 192.168.231.152  netmask 255.255.255.0  broadcast 192.168.231.255
            inet6 fe80::e3a3:533b:4112:90d5  prefixlen 64  scopeid 0x20<link>
            ether 00:0c:29:ca:f5:28  txqueuelen 1000  (Ethernet)
            RX packets 3507  bytes 288058 (281.3 KiB)
            RX errors 0  dropped 0  overruns 0  frame 0
            TX packets 1958  bytes 256066 (250.0 KiB)
            TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
     
    lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
            inet 127.0.0.1  netmask 255.0.0.0
            inet6 ::1  prefixlen 128  scopeid 0x10<host>
            loop  txqueuelen 1000  (Local Loopback)
            RX packets 247120  bytes 90060437 (85.8 MiB)
            RX errors 0  dropped 0  overruns 0  frame 0
            TX packets 247120  bytes 90060437 (85.8 MiB)
            TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
     
    virbr0: flags=4099<UP,BROADCAST,MULTICAST>  mtu 1500
            inet 192.168.122.1  netmask 255.255.255.0  broadcast 192.168.122.255
            ether 52:54:00:84:91:8b  txqueuelen 1000  (Ethernet)
            RX packets 0  bytes 0 (0.0 B)
            RX errors 0  dropped 0  overruns 0  frame 0
            TX packets 0  bytes 0 (0.0 B)
            TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
    ```
   
2. 获取网关，Gateway下面的内容为网关（192.168.231.2）

    ```shell
    [node@k8s-master ~]$ netstat -rn
    Kernel IP routing table
    Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
    0.0.0.0         192.168.231.2   0.0.0.0         UG        0 0          0 ens33
    192.168.122.0   0.0.0.0         255.255.255.0   U         0 0          0 virbr0
    192.168.231.0   0.0.0.0         255.255.255.0   U         0 0          0 ens33
    ```
   
3. 获取DNS，nameserver后的内容为DNS（192.168.231.2）

    ```shell
    [node@k8s-master ~]$ cat /etc/resolv.conf
    # Generated by NetworkManager
    nameserver 192.168.231.2
    ```

4. 修改`/etc/sysconfig/network-scripts/ifcfg-ens33`文件（ens33为网卡名称，根据实际情况修改）

    ```
    TYPE=Ethernet
    PROXY_METHOD=none
    BROWSER_ONLY=no
    BOOTPROTO=static # 从 dhcp 修改为 static
    DEFROUTE=yes
    IPV4_FAILURE_FATAL=no
    IPV6INIT=yes
    IPV6_AUTOCONF=yes
    IPV6_DEFROUTE=yes
    IPV6_FAILURE_FATAL=no
    IPV6_ADDR_GEN_MODE=stable-privacy
    NAME=ens33
    UUID=2de148e1-945e-4744-bc6d-18394e985967
    DEVICE=ens33
    ONBOOT=yes
    # 下面为新增内容
    IPADDR=192.168.231.152 # 静态 IP
    NETMASK=255.255.255.0 # 子网掩码
    GATEWAY=192.168.231.2 # 网关
    DNS1=192.168.231.2  # DNS
    ```

5. 重启网络，以便配置生效

   ```shell
   # 老系统执行
   sudo systemctl restart network
   
   # 新系统执行
   sudo systemctl restart NetworkManager
   ```

结语
---

在本文中，我们详细阐述了在Hyper-V环境下安装红帽系列Linux虚拟机并配置静态IP的全过程。通过配置虚拟交换机、创建虚拟机，到获取网络参数（IP、子网掩码、网关、DNS），逐步引导读者完成环境搭建和网络设置，为后续运维和调试提供理论依据和操作指导。

同时，我们重点讲解了如何修改网络配置文件，使系统能稳定使用静态IP，并附带了相应命令和截图示例。希望这一系列步骤能帮助大家快速搭建测试环境，提高对Linux网络管理及故障排查能力。

未来在实际部署中，读者可根据需要灵活调整配置，解决可能遇到的各种网络问题，实现系统稳定运行，从而为生产环境部署奠定良好基础。